"use strict";function AddWordTranslationsCtrl(a,b,c,d,e,f,g,h){a.languageId=d,a.wordTranslationsToAdd=[],a.searchWordTranslations=function(b){return g.searchForWordTranslations(b,a.languageId).then(function(a){return a},function(a){f.showResultModal("Search Word Translations","Error while searching Word Translations",!1)})},a.addWordTranslation=function(){if(a.selectedWordTranslation&&a.selectedWordTranslation.Id){for(var b=0;b<e.length;b++)if(a.selectedWordTranslation.Id===e[b].Id)return void f.showResultModal("Add Word Translation","This Translation already exists in Word Suite",!1);for(var b=0;b<a.wordTranslationsToAdd.length;b++)if(a.selectedWordTranslation.Id===a.wordTranslationsToAdd[b].Id)return void f.showResultModal("Add Word Translation","You have already added this Translation",!1);a.wordTranslationsToAdd.push(a.selectedWordTranslation),a.selectedWordTranslation=null}},a.removeWordTranslation=function(b){a.wordTranslationsToAdd.splice(b,1)},a.save=function(){for(var d=[],e=0;e<a.wordTranslationsToAdd.length;e++)d.push({WordSuiteId:c,WordTranslationId:a.wordTranslationsToAdd[e].Id,IsStudentWord:!0});h.addWordProgresses(d).then(function(a){b.close(!0)},function(a){f.showResultModal("Add Word Translations","Failed to add Word Translations to the Word Suite",!1)})},a.close=function(){b.dismiss()}}function LanguageCtrl(a,b,c,d){a.addLanguage=function(){if(a.newLanguageName){var b={name:a.newLanguageName};d.addLanguage(b).then(function(a){a>0?(c.showResultModal("Add language","Language added successfully",!0),e()):c.showResultModal("Add language","Failed to add language",!1)},function(a){c.showResultModal("Add language","Failed to add language",!1)})}},a.removeLanguage=function(f){var g=b.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Delete Language"},bodyText:function(){return"Are you sure you want to delete "+a.languages[f].Name+"? This action will delete all "+a.languages[f].Name.toLowerCase()+" words and Word Suites."}}});g.result.then(function(b){b&&d.removeLanguage(a.languages[f].Id).then(function(a){c.showResultModal("Delete language","Language deleted successfully",!0),e()},function(a){c.showResultModal("Delete language","Failed to delete language. It may be assigned to some courses.",!1)})})};var e=function(){d.getAllLanguages().then(function(b){for(var c=0;c<b.length;c++)if("Ukrainian"===b[c].Name){b.splice(c,1);break}a.languages=b,a.newLanguageName=null},function(a){c.showResultModal("Load languages","Failed to load languages",!1)})};e()}function CreateWordSuiteCtrl(a,b,c,d,e,f,g,h){a.wordTranslationsToAdd=[],a.languageChanged=function(){if(a.wordTranslationsToAdd.length){var b=c.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Change language"},bodyText:function(){return"This action will remove all WordTranslations from WordSuite. Do you want to continue?"}}});b.result.then(function(b){b?(i=a.language,a.wordTranslationsToAdd=[],a.selectedWordTranslation=null):a.language=i})}else i=a.language,a.selectedWordTranslation=null},a.searchWordTranslations=function(b){return g.searchForWordTranslations(b,a.language.Id).then(function(a){return a},function(a){d.showResultModal("Search Word Translations","Error while searching Word Translations",!1)})},a.addWordTranslationToWordSuite=function(){if(a.selectedWordTranslation&&a.selectedWordTranslation.Id){for(var b=0;b<a.wordTranslationsToAdd.length;b++)if(a.selectedWordTranslation.Id===a.wordTranslationsToAdd[b].Id)return void d.showResultModal("Add Word Translation","You have already added this Translation",!1);a.wordTranslationsToAdd.push(a.selectedWordTranslation),a.selectedWordTranslation=null}},a.removeWordTranslation=function(b){a.wordTranslationsToAdd.splice(b,1)},a.saveWordSuite=function(){if(k()&&a.wordTranslationsToAdd.length){for(var b=[],c=0;c<a.wordTranslationsToAdd.length;c++)b.push(a.wordTranslationsToAdd[c].Id);var d={Name:a.name,LanguageId:a.language.Id,Threshold:parseInt(a.threshold),QuizResponseTime:parseInt(a.quizResponseTime),OwnerId:e.getUserData().id,WordTranslationsId:b};f.createWordSuite(d).then(function(a){m("Create WordSuite","WordSuite successfully created",!0)},function(a){m("Create WordSuite",a.Message,!1)})}},a.openImportModal=function(){var b=c.open({templateUrl:"modalImport",controller:"ImportWordTranslationsController",size:"lg",resolve:{languageId:function(){return a.language.Id}}});b.result.then(function(b){for(var c=0;c<b.length;c++){for(var d=!1,e=0;e<a.wordTranslationsToAdd.length;e++)if(b[c].Id===a.wordTranslationsToAdd[e].Id){d=!0;break}d||a.wordTranslationsToAdd.push(b[c])}})};var i,j=function(){h.getAllLanguages().then(function(b){for(var c=0;c<b.length;c++)if("Ukrainian"===b[c].Name){b.splice(c,1);break}a.languages=b,l()},function(a){m("Load languages","Failed to load languages",!1)})},k=function(){return a.isEnteredName=Boolean(a.name),a.isEnteredLanguage=Boolean(a.language),a.isEnteredThreshold=Boolean(a.threshold),a.isEnteredQuizResponseTime=Boolean(a.quizResponseTime),a.isEnteredName&&a.isEnteredLanguage&&a.isEnteredThreshold&&a.isEnteredQuizResponseTime},l=function(){var b=JSON.parse(localStorage.getItem("wordSuiteData"));if(b){for(var c=0;c<a.languages.length;c++)if(a.languages[c].Id===b.languageId){a.language=a.languages[c],i=a.language;break}a.wordTranslationsToAdd=angular.copy(b.importedWordTranslations),localStorage.setItem("wordSuiteData",JSON.stringify(null))}},m=function(a,d,e){var f=c.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return a},bodyText:function(){return d},success:function(){return e}}});f.result.then(function(){e&&(localStorage.getItem("areSomeData")&&(b.location.href=localStorage.getItem("areSomeData")),b.location.href="Index#/WordSuites")})};j()}function EditWordSuiteCtrl(a,b,c,d,e,f,g,h,i){a.newWordTranslations=[],a.searchWordTranslations=function(b){return h.searchForWordTranslations(b,a.wordSuite.LanguageId).then(function(a){return a},function(a){e.showResultModal("Search Word Translations","Error while searching Word Translations",!1)})},a.removeExistingWordTranslation=function(b){o.push(a.existingWordTranslations[b].Id),a.existingWordTranslations.splice(b,1)},a.removeNewWordTranslation=function(b){a.newWordTranslations.splice(b,1)},a.addWordTranslationToWordSuite=function(){if(a.selectedWordTranslation&&a.selectedWordTranslation.Id){for(var b=0;b<a.existingWordTranslations.length;b++)if(a.selectedWordTranslation.Id===a.existingWordTranslations[b].Id)return void e.showResultModal("Add Word Translation","This Translation already exists in Word Suite",!1);for(var b=0;b<a.newWordTranslations.length;b++)if(a.selectedWordTranslation.Id===a.newWordTranslations[b].Id)return void e.showResultModal("Add Word Translation","You have already added this Translation",!1);a.newWordTranslations.push(a.selectedWordTranslation),a.selectedWordTranslation=null}},a.openImportModal=function(){var b=c.open({templateUrl:"modalImport",controller:"ImportWordTranslationsController",size:"lg",resolve:{languageId:function(){return a.wordSuite.LanguageId}}});b.result.then(function(b){for(var c=0;c<b.length;c++){for(var d=!1,e=0;e<a.newWordTranslations.length;e++)if(b[c].Id===a.newWordTranslations[e].Id){d=!0;break}if(!d)for(var e=0;e<a.existingWordTranslations.length;e++)if(b[c].Id===a.existingWordTranslations[e].Id){d=!0;break}d||a.newWordTranslations.push(b[c])}})},a.saveWordSuite=function(){if(p()&&(a.newWordTranslations.length||a.existingWordTranslations.length)){for(var b=0;b<a.newWordTranslations.length;b++)n.push(a.newWordTranslations[b].Id);q()&&g.editWordSuite({Id:a.wordSuite.Id,Name:a.wordSuite.Name,LanguageId:a.wordSuite.LanguageId,Threshold:a.wordSuite.Threshold,QuizResponseTime:a.wordSuite.QuizResponseTime,WordTranslationsToAddIdRange:n,WordTranslationsToDeleteIdRange:o,IsBasicInfoChanged:m}).then(function(a){r("Edit Word Suite","Word Suite successfully edited",!0)},function(a){r("Edit Word Suite",a.Message,!1)})}};var j=null,k=null,l=null,m=!1,n=[],o=[],p=function(){return a.isEnteredName=Boolean(a.wordSuite.Name),a.isEnteredThreshold=Boolean(a.wordSuite.Threshold),a.isEnteredQuizResponseTime=Boolean(a.wordSuite.QuizResponseTime),a.isEnteredName&&a.isEnteredThreshold&&a.isEnteredQuizResponseTime},q=function(){return m=j!==a.wordSuite.Name||k!==a.wordSuite.Threshold||l!=a.wordSuite.QuizResponseTime,m||n.length||o.length},r=function(a,d,e){var f=c.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return a},bodyText:function(){return d},success:function(){return e}}});f.result.then(function(){e&&(b.location.href="Index#/WordSuites")})},s=function(b){g.getWordSuiteByID(b).then(function(b){a.wordSuite=b,a.wordSuite&&(j=a.wordSuite.Name,k=a.wordSuite.Threshold,l=a.wordSuite.QuizResponseTime,h.getWordTranslationsByWordSuiteID(a.wordSuite.Id).then(function(b){a.existingWordTranslations=b}))})};s(d.wordSuiteId)}function WordSuitesCtrl(a,b,a,c,d,e){b.wordSuites=[],b.wordSuitesToShow=[],b.wordSuitesToShowCount=0,b.showWordSuites=function(){var a=(b.currentPage-1)*b.itemsPerPage,c=a+b.itemsPerPage;if("Date"===b.orderBy&&b.wordSuites.sort(f("Id")),"Name"===b.orderBy&&b.wordSuites.sort(f("Name")),b.searchName){for(var d=[],e=0;e<b.wordSuites.length;e++)-1!=b.wordSuites[e].Name.toLowerCase().indexOf(b.searchName)&&d.push(b.wordSuites[e]);b.wordSuitesToShow=d.slice(a,c),b.wordSuitesToShowCount=d.length}else b.wordSuitesToShow=b.wordSuites.slice(a,c),b.wordSuitesToShowCount=b.wordSuites.length},b.removeWordSuite=function(f){var h=a.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Delete WordSuite"},bodyText:function(){return"Are you sure you want to delete this Word Suite?"}}});h.result.then(function(a){a&&e.deleteWordSuite(b.wordSuites[f].Id).then(function(a){g(d.getUserData().id)},function(a){c.showResultModal("Delete Word Suite","Failed to delete Word Suite. Some students may be assigned to it.",!1)})})};var f=function(a){return function(b,c){return result=b[a]<c[a]?-1:b[a]>c[a]?1:0}},g=function(a){e.getWordSuitesByOwnerID(a).then(function(a){b.wordSuites=a,b.showWordSuites()},function(a){c.showResultModal("Load Word Suites","Failed to load Word Suites",!1)})};g(d.getUserData().id)}app.controller("AddGroupController",function(a,b,c,d){a.showSuccess=!1,a.showFailure=!1,a.showFailureEmptyName=!1,a.failureEmptyNameMessage="Please enter the name for your group!",a.init=function(){c.getAllCourses().then(function(b){a.names=b,a.names.length>0&&(a.courseIdValue=a.names[0].Id)})},a.submitButtonClick=function(){a.hideSuccess(),a.hideFailure(),a.hideFailureEmptyName();var b={name:a.nameValue,courseId:a.courseIdValue,ownerId:d.getUserData().id};b.name?c.createGroup(b).then(function(b){a.notifySuccess()},function(b){a.notifyFailure(b.Message)}):a.notifyFailureEmptyName()},a.notifySuccess=function(){a.successMessage="Group "+a.nameValue+" has been added.",a.showSuccess=!0},a.notifyFailure=function(b){null==b?a.failureMessage="SomethingWrong":a.failureMessage=b,a.showFailure=!0},a.notifyFailureEmptyName=function(){a.showFailureEmptyName=!0},a.hideSuccess=function(){a.showSuccess=!1},a.hideFailure=function(){a.showFailure=!1},a.hideFailureEmptyName=function(){a.showFailureEmptyName=!1},a.init()}),app.controller("AddWordTranslationsModalController",AddWordTranslationsCtrl),app.controller("ChangePasswordController",function(a,b,c,d,e){var f=a.id;b.changePasswordClick=function(){b.errorMessage="";var a={login:b.nameValue,password:b.passwordValue,email:b.emailValue,id:f};b.passwordValue&&b.repeatPasswordValue?b.passwordValue!==b.repeatPasswordValue?b.errorMessage=e.invalidConfirmPassword:d.changePassword(a).then(function(a){a?window.location.replace("/Index#/PasswordChanged"):b.errorMessage=e.invalidInput},function(){b.errorMessage=e.cantHandleRequest}):b.errorMessage=e.invalidPassword}}),app.controller("ConfirmModalController",function(a,b,c,d){a.titleText=c,a.bodyText=d,a.yes=function(){b.close(!0)},a.no=function(){b.close(!1)}}),app.controller("CourseController",function(a,b,c,d,e){var f=function(){b.topCount=5,e.getUserData()&&d.getEnrollCourses().then(function(a){b.enrollCourses=a,a.length||location.replace("Index#/UnassignedModal")})};f()}),app.controller("CourseDetailController",function(a,b,c,d){var e=function(){localStorage.setItem("courseId",JSON.stringify(c.Id)),d.getCourseDetail(c.Id).then(function(b){a.course=b})};e()}),app.controller("CreateCourseController",function(a,b,c,d,e,f,g,h){a.dropSuccessHandler=function(a,b,c){c.splice(b,1)},a.onDrop=function(a,b,c){c.push(b)},a.enableTooltip=function(){return!(Boolean(a.course.Name)&&Boolean(a.course.Language)&&Boolean(a.course.WordSuites.length))},a.goToCourses=function(){b.location.href="Index#/UserCourses"},a.open=function(a,b,d,e){var f=c.open({animation:!0,templateUrl:a,controller:"ModalController",size:"sm",resolve:{data:function(){return d}}});f.result.then(b,e)},a.getWordSuitesForCurrentLanguage=function(){return d(function(b){f.getWordSuitesByLanguageID(a.course.Language.Id).then(function(c){a.wordSuites=c,b(a.wordSuites)})})},a.saveCurrentState=function(){localStorage.setItem("course",JSON.stringify(a.course)),localStorage.setItem("Location",window.location.href),b.location.href="Index#/CreateWordSuite"},a.saveCourse=function(){if(j()){var b={Name:a.course.Name,LanguageId:a.course.Language.Id,OwnerId:e.getUserData().id,WordSuites:a.course.WordSuites};h.createCourse(b).then(function(b){a.open("Modal",a.goToCourses,{header:"Create Course",message:"Course successfully added"},a.goToCourses)},function(b){a.open("Modal",a.isCorrectInput,{header:"Create Course",message:error.ExceptionMessage||error.Message||"Unknown error"})})}};var i=function(a,b){for(var c=0;c<a.length;c++)if(a[c].Id===b.Id)return!0;return!1},j=function(){return a.isEnteredName=Boolean(a.course.Name),a.isEnteredLanguage=Boolean(a.course.Language),a.isSelectedWordSuites=Boolean(a.course.WordSuites.length),a.isEnteredName&&a.isEnteredLanguage&&a.isSelectedWordSuites},k=function(){a.course={Name:null,Language:null,WordSuites:[]},a.wordSuites=[],g.getAllLanguages().then(function(b){a.languages=b}),localStorage.getItem("Location")&&(localStorage.removeItem("Location"),a.course=JSON.parse(localStorage.getItem("course")),a.course.Language&&a.getWordSuitesForCurrentLanguage().then(function(){JSON.parse(localStorage.getItem("course")).WordSuites.length&&(a.wordSuites=a.wordSuites.filter(function(b){return!i(a.course.WordSuites,b)}))}))};k()}),app.controller("CreateWordTranslationController",function(a,b,c,d,e,f,g,h,i,j,k){a.lang=k,a.wordsToSearch=10,a.selectedWord="",a.selectedTranslation="",a.IdOfAdded=null,a.searchWords=function(b){return f.searchForWords(b,a.lang,a.wordsToSearch).then(function(a){return a})},a.searchTranslations=function(b){return f.searchForTranslations(b,a.wordsToSearch).then(function(a){return a})};var l=function(b,c){var d={OriginalWord:b.Value,TranslationWord:c.Value,OriginalWordId:b.Id,TranslationWordId:c.Id,Transcription:b.Transcription,Description:b.Description,LanguageId:b.LanguageId,OwnerId:i.getUserData().id};g.addWordTranslation(d).then(function(b){a.IdOfAdded=b,h.showResultModal(j.successTitleForModal,j.messageWhenWordTranslationIsAdded,!0)},function(a){h.showResultModal(j.failureTitleForModal,String(a.Message),!1)})};a.ManipulateData=function(){return""===a.selectedTranslation||""===a.selectedWord?void h.showResultModal(j.failureTitleForModal,j.messageWhenSomeRequiredFieldsAreEmpty,!1):("object"!=typeof a.selectedWord&&h.showResultModal(j.failureTitleForModal,j.messageWhichSaysThatYouMustChooseValueFromDropdownList,!1),void("object"==typeof a.selectedWord&&"object"==typeof a.selectedTranslation?l(a.selectedWord,a.selectedTranslation):"object"==typeof a.selectedWord&&"object"!=typeof a.selectedTranslation&&f.addWord({Value:a.selectedTranslation,LanguageId:4}).then(function(b){f.getWordById(b).then(function(b){l(a.selectedWord,b)})})))},a.close=function(){e.close(a.IdOfAdded)},a.cancel=function(){e.dismiss("cancel")},a.openForWord=function(){var b=d.open({animation:!0,templateUrl:"Views/AddWord.html",controller:"WordsController",size:"lg",resolve:{language:function(){return a.lang}}});b.result.then(function(){})},a.openForTranslation=function(){var a=d.open({animation:!0,templateUrl:"Views/AddWord.html",controller:"WordsController",size:"lg",resolve:{language:function(){return 4}}});a.result.then(function(){})}}),app.controller("EditCourseController",function(a,b,c,d,e,f,g){b.dropSuccessHandler=function(a,b,c){c.splice(b,1)},b.onDrop=function(a,b,c){c.push(b)},b.saveCurrentState=function(){localStorage.setItem("course",JSON.stringify(b.course)),localStorage.setItem("Location",window.location.href),c.location.href="Index#/CreateWordSuite"},b.goToCourses=function(){c.location.href="Index#/UserCourses"},b.open=function(b,c,d,e){var f=a.open({animation:!0,templateUrl:b,controller:"ModalController",size:"sm",resolve:{data:function(){return d}}});f.result.then(c,e)},b.enableTooltip=function(){return!(Boolean(b.course.Name)&&Boolean(b.course.WordSuites.length))},b.saveCourse=function(){i()&&g.editCourse(b.course).then(function(a){b.open("Modal",b.goToCourses,{header:"Edit Course",message:"Course successfully saved"},b.goToCourses)},function(a){b.open("Modal",b.isCorrectInput,{header:"Edit Course",message:error.ExceptionMessage||error.Message||"Unknown error"})})};var h=function(a,b){for(var c=0;c<a.length;c++)if(a[c].Id===b.Id)return!0;return!1},i=function(){return b.isEnteredName=Boolean(b.course.Name),b.isSelectedWordSuites=Boolean(b.course.WordSuites.length),b.isEnteredName&&b.isSelectedWordSuites},j=function(){g.getCourse(d.courseId).then(function(a){b.course=a}).then(function(){f.getWordSuitesByLanguageID(b.course.Language.Id).then(function(a){b.wordSuites=a.filter(function(a){return!h(b.course.WordSuites,a)})}).then(function(){localStorage.getItem("Location")&&(localStorage.removeItem("Location"),b.course=JSON.parse(localStorage.getItem("course")),b.course.Language&&b.getWordSuitesForCurrentLanguage().then(function(){JSON.parse(localStorage.getItem("course")).WordSuites.length&&(b.wordSuites=b.wordSuites.filter(function(a){return!h(b.course.WordSuites,a)}))}))})})};j()}),app.controller("EditUserProfileController",function(a,b,c){var d,e=function(){a.userCurrentPassword=null,a.userNewPassword=null,a.userConfirmNewPassword=null},f=function(){a.userNewName=null},g=function(){a.showLabel=!1,a.message=c.savedSettings},h=function(b){a.message=b,a.showLabel=!0},i=function(){return sessionStorage.strength>=c.strength?a.userCurrentPassword&&a.userNewPassword===a.userConfirmNewPassword&&a.userNewPassword:!1},j=function(a){return a[c.name].length>c.nameLength&&a[c.surname].length>c.nameLength};a.$watch("userNewPassword",function(){a.showStrenght=a.userNewPassword?!1:!0}),a.$watch("userNewName",function(){if(a.userNewName){var b=a.userNewName.split(" ");d=j(b)?!0:!1}}),a.userName=b.getUserName().then(function(b){a.userName=b},function(){a.userName=c.nameNotFound}),a.hideData=function(){a.showName=!1,a.showPassword=!1,e(),f(),g()},a.hideNameTitle=function(){a.showName=!0,a.showPassword=!1,f(),g()},a.hidePasswordTitle=function(){a.showPassword=!0,a.showName=!1,e(),g()};var k=function(){b.editUserName(a.userNewName).then(function(){a.showName=!1,a.userName=a.userNewName,a.$parent.userName=a.userNewName,f(),h(c.savedSettings)},function(){f(),h(c.wrongName)}),a.showName=!1,g()},l=function(){b.passwordIsInBase(a.userCurrentPassword).then(function(){b.editUserPassword(a.userNewPassword).then(function(){a.showPassword=!1,e(),h(c.savedSettings)})},function(){e(),h(c.wrongPassword)}),a.showPassword=!1,g()};a.submitChangeName=function(){d?k():h(c.invalidName)},a.submitChangePassword=function(){i()?l():h(c.invalidConfirmPassword)}}),app.controller("EmailConfirmedController",function(a,b,c){var d=b.code,e=b.id;c.get("/api/register/ConfirmEmail",{params:{code:d,userId:e}}).success(function(){a.stateMessage="Success!",a.actionMessage="You may now login."}).error(function(){a.stateMessage="Failure...",a.actionMessage="Try again later."})}),app.controller("GlobalDictionaryController",function(a,b,c,d,e,f,g){a.initialize=function(){a.selectedPage=1,a.isLanugageSelected=!1,a.WORDS_ON_PAGE=f.WORDS_ON_PAGE,a.selectedLanguageId=0,a.wordsAmount=0,g.getAllLanguages().then(function(b){a.languages=b;for(var c=0;c<a.languages.length;++c)if("Ukrainian"===a.languages[c].Name){a.languages.splice(c,1);break}})},a.changeDataToShow=function(){e.getWordTranslationsFromInterval((a.selectedPage-1)*f.WORDS_ON_PAGE,Math.min(a.selectedPage*f.WORDS_ON_PAGE,a.wordsAmount),a.selectedLanguageId).then(function(b){a.toShow=b})},a.selectLanguage=function(){a.isLanguageSelected=!0,a.selectedPage=1,e.getAmountOfWordTranslationsBySpecificLanguage(a.selectedLanguageId).then(function(b){a.wordsAmount=b,e.getWordTranslationsFromInterval((a.selectedPage-1)*f.WORDS_ON_PAGE,Math.min(a.selectedPage*f.WORDS_ON_PAGE,a.wordsAmount),a.selectedLanguageId).then(function(b){a.toShow=b})})},a.open=function(){var b=d.open({animation:!0,templateUrl:"Views/CreateWordTranslation.html",controller:"CreateWordTranslationController",size:"lg",resolve:{languageId:function(){return a.selectedLanguageId}}});b.result.then(function(){})},a.openImportModal=function(){var b=d.open({templateUrl:"modalImport",controller:"ImportWordTranslationsController",size:"lg",resolve:{languageId:function(){return a.selectedLanguageId}}});b.result.then(function(b){b?(a.importedWordTranslations=b,a.openImportResultModal("Import Word Translations","Word Translations successfully imported",!0,"Create Word Suite from Word Translations")):a.openImportResultModal("Import Word Translations","Failed to import Word Translations",!1,null)})},a.openImportResultModal=function(b,c,e,f){var g=d.open({templateUrl:"messageWithActionModal",controller:"MessageWithActionModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return b},bodyText:function(){return c},success:function(){return e},actionButtonText:function(){return f}}});g.result.then(function(b){e&&b&&a.createWordSuite()})},a.createWordSuite=function(){var c={importedWordTranslations:a.importedWordTranslations,languageId:Number(a.selectedLanguageId)};localStorage.setItem("wordSuiteData",JSON.stringify(c)),b.location.href="Index#/CreateWordSuite"},a.initialize()}),app.controller("GroupController",function(a,b,a,c){b.init=function(){b.currentPage=1,b.itemsPerPage=5,b.groupsToShowCount=0,b.groups=[],b.groupsToShow=[],b.orderBy="Date",c.getAllGroups().then(function(a){b.groups=a,b.showGroups()})};var d=function(a){return function(b,c){return result=b[a]<c[a]?-1:b[a]>c[a]?1:0}};b.showGroups=function(){var a=(b.currentPage-1)*b.itemsPerPage,c=a+b.itemsPerPage;if("Date"===b.orderBy&&b.groups.sort(d("Id")),"Name"===b.orderBy&&b.groups.sort(d("Name")),b.searchName){for(var e=[],f=0;f<b.groups.length;f++)-1!=b.groups[f].Name.toLowerCase().indexOf(b.searchName.toLowerCase())&&e.push(b.groups[f]);b.groupsToShow=e.slice(a,c),b.groupsToShowCount=e.length}else b.groupsToShow=b.groups.slice(a,c),b.groupsToShowCount=b.groups.length},b.deleteGroupById=function(d){var e=a.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Delete Group"},bodyText:function(){return"Are you sure? Some students may be enrolled to this group."}}});e.result.then(function(e){e&&c.deleteGroupById(d).then(function(a){b.init()},function(b){a.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",resolve:{titleText:function(){return"Error!"},bodyText:function(){return b.ExceptionMessage||b.Message||"Unknown error"},success:function(){return!1}}})})})},b.init()}),app.controller("GroupDetailsController",function(a,b,a,c,d,e){b.init=function(){b.currentPage=1,b.itemsPerPage=3,b.enrollmentsWithProgressesToShowCount=0,b.enrollmentsWithProgresses=[],b.enrollmentsWithProgressesToShow=[],b.isPassedValueValid=f(c.groupId),b.isPassedValueValid&&(b.userModels=[],b.userConfig={scrollableHeight:"250px",scrollable:!0,enableSearch:!0,displayProp:"Name",idProp:"Id",externalIdProp:"",smartButtonMaxItems:3,smartButtonTextConverter:function(a,b){return a}},e.getGroupById(c.groupId).then(function(a){b.group=a,null==b.group?b.isPassedValueValid=!1:(d.getEnrollmentsByGroupId(c.groupId).then(function(a){b.enrollmentsWithProgresses=a,b.showEnrollments()}),d.getUsersNotBeongingToGroup(c.groupId).then(function(a){b.users=a}))}))},b.showEnrollments=function(){var a=(b.currentPage-1)*b.itemsPerPage,c=a+b.itemsPerPage;if(b.searchName){for(var d=[],e=0;e<b.enrollmentsWithProgresses.length;e++)-1!=b.enrollmentsWithProgresses[e].Enrollment.User.Name.toLowerCase().indexOf(b.searchName.toLowerCase())&&d.push(b.enrollmentsWithProgresses[e]);b.enrollmentsWithProgressesToShow=d.slice(a,c),b.enrollmentsWithProgressesToShowCount=d.length}else b.enrollmentsWithProgressesToShow=b.enrollmentsWithProgresses.slice(a,c),b.enrollmentsWithProgressesToShowCount=b.enrollmentsWithProgresses.length},b.submitButtonClick=function(){d.enrollUsersToGroup(b.userModels,c.groupId).then(function(a){b.init()},function(a){window.alert(a.ExceptionMessage||a.Message||"Unknown error")})},b.deleteEnrollmentById=function(c){var e=a.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Are you sure?"},bodyText:function(){return"This person may be a great student..."}}});e.result.then(function(e){e&&d.deleteEnrollmentById(c).then(function(a){b.init()},function(b){a.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",resolve:{titleText:function(){return"Error!"},bodyText:function(){return b.ExceptionMessage||b.Message||"Unknown error"},success:function(){return!1}}})})})};var f=function(a){var b=/^\d+$/;return b.test(a)};b.init()}),app.controller("ImportWordTranslationsController",function(a,b,c,d,e){a.wordTranslations=[],a.itemsPerPage=21,a.currentPage=1,a.getFileName=function(){a.fileName=document.getElementById("file").value.replace("C:\\fakepath\\",""),a.$apply()},a.openFile=function(){if(a.fileName.indexOf(".txt")==a.fileName.length-4){a.wordTranslations=[],a.areAllSelected=!0;var b=document.getElementById("file").files[0],c=new FileReader;c.onloadend=function(b){for(var c=/(.+)=([^\[\]\{\}]+)(?:\[(.*)\])? ?(?:\{(.*)\})?/,d=b.target.result.replace(/\t/g,"").replace(/ +/g," ").split("\n"),e=0;e<d.length;e++)c.test(d[e])&&a.wordTranslations.push({originalWord:c.exec(d[e])[1].trim(),translationWord:c.exec(d[e])[2].trim(),transcription:c.exec(d[e])[3],description:c.exec(d[e])[4],isChosen:!0});a.showWordTranslations(),a.$apply()},c.readAsText(b,"utf-8")}},a.showWordTranslations=function(){var b=(a.currentPage-1)*a.itemsPerPage,c=b+a.itemsPerPage;a.wordTranslationsToShow=a.wordTranslations.slice(b,c)},a.selectAll=function(b){for(var c=0;c<a.wordTranslations.length;c++)a.wordTranslations[c].isChosen=b},a.checkAllSelected=function(){for(var b=0;b<a.wordTranslations.length;b++)if(!a.wordTranslations[b].isChosen)return void(a.areAllSelected=!1);a.areAllSelected=!0},a["import"]=function(){for(var b=[],f=0;f<a.wordTranslations.length;f++)a.wordTranslations[f].isChosen&&b.push({OriginalWord:a.wordTranslations[f].originalWord,TranslationWord:a.wordTranslations[f].translationWord,Transcription:a.wordTranslations[f].transcription,Description:a.wordTranslations[f].description,LanguageId:e});b.length&&(a.isProcessing=!0,d.importWordTranslations(b).then(function(b){b?c.close(b):a.openImportResultModal("Import Word Translations","Failed to import Word Translations",!1)}))},a.openImportResultModal=function(a,c,d){b.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return a},bodyText:function(){return c},success:function(){return d}}})},a.cancel=function(){c.dismiss("cancel")}}),app.controller("IndexController",function(a,b,c,d,e,f,g,h){var i=g.getUserName().then(function(a){i=a,b.userName=i}),j=f.getUserData();b.showIcon=!0,b.showWordSuitesIcon=!0,b.sideBarIsMinimized=!1,b.isLoggedIn=function(){return!!j},b.getName=i,b.isStudent=j&&j.roles.indexOf(h.StudentRole)>=0,b.isTeacher=j&&j.roles.indexOf(h.TeacherRole)>=0,b.isAdmin=j&&j.roles.indexOf(h.AdminRole)>=0,b.onLogoClick=function(){j&&(j.roles.indexOf(h.StudentRole)>=0?location.replace("/Index#/Courses/"):j.roles.indexOf(h.TeacherRole)>=0?location.replace("Index#/TeacherManager"):j.roles.indexOf(h.AdminRole)>=0&&location.replace("Index#/Users"))},j&&(j.roles.indexOf(h.TeacherRole)>=0&&(b.showWordSuitesIcon=!1),b.userIconURL=j.id+".png"),b.logOut=function(){f.setUserData(null),a.defaults.headers.common.Authorization=null,j=f.getUserData(),location.replace("/Index#/")},b.openLoginModal=function(){var a=d.open({templateUrl:"../Views/LoginModal.html",controller:"LoginController",size:h.small});a.result.then()},b.openRegisterModal=function(){var a=d.open({templateUrl:"../Views/RegisterModal.html",controller:"RegisterController",size:h.small});a.result.then()},b.toggleSidebar=function(){b.sideBarIsMinimized=!b.sideBarIsMinimized,b.showIcon=!b.showIcon},b.getBodySidebarClass=function(){return b.isLoggedIn()?b.sideBarIsMinimized?h.sidebarMinimized:null:h.sidebarClosed},b.showCoursePage=function(){h.coursePath===document.URL?b.showCourseList=!1:(location.replace("Index#/Courses"),b.showCourseList=!0)},b.showTeacherManager=function(){h.teacherPath===document.URL?b.showManagerList=!1:(location.replace("Index#/TeacherManager"),b.showManagerList=!0)},b.showManagersList=function(){b.showManagerList=!1},b.showCoursesList=function(){b.showCourseList=!1}}),app.controller("LanguageController",LanguageCtrl),app.controller("LoginController",function(a,b,c,d,e,f,g,h,i){var j=i.zero,k=function(a,b){for(var c=i.zero;c<a.length;c++)if(a[c]===b)return!0;return!1};b.closeModal=function(){d.close()},b.loginHideAndRedirectToResetPassword=function(){d.close(),location.replace("/Index#/ForgotPassword")},b.openForgotPasswordModal=function(){d.close(),c.open({templateUrl:"../Views/ForgotPasswordModal.html",controller:"ResetPasswordController",size:i.small})},b.loginButtonClick=function(){if(j)b.errorMessage=i.pleaseWaitMessage;else{j++,b.errorMessage="";var a=b.onceReloading,c={email:b.email,password:b.password},d=function(a){h.setUserData(a),b.isLoggedIn=g.isLoggedInto(),k(a.roles,i.StudentRole)?location.replace("/Index#/Courses/"):k(a.roles,i.TeacherRole)?location.replace("/Index#/TeacherManager/"):location.replace("/Index#/Users/")},e=function(b){a?(a=i.zero,d(b)):(a++,d(b),location.reload(!0))};c.email&&c.password?f.login(c).then(function(a){a?e(a):(j=i.zero,b.errorMessage=i.wrongEmailOrPassword)},function(){j=i.zero,b.errorMessage=i.wrongEmailOrPassword}):(j=i.zero,b.errorMessage=i.wrongEmailOrPassword)}}}),app.controller("MessageModalController",function(a,b,c,d,e){a.titleText=c,a.bodyText=d,a.success=e,a.ok=function(){b.close()}}),app.controller("MessageWithActionModalController",function(a,b,c,d,e,f){a.titleText=c,a.bodyText=d,a.success=e,a.actionButtonText=f,a.ok=function(){b.close(!1)},a.action=function(){b.close(!0)}}),app.controller("MyPageController",function(a,b,c){}),app.controller("QuizController",function(a,b,c,d,e){a.$on("$locationChangeStart",function(b){a.isTimeOut||(b.preventDefault(),a.ConfirmSubmit())}),a.open=function(a,b,c,e){var f=d.open({animation:!0,templateUrl:a,controller:"ModalController",size:"sm",resolve:{data:function(){return c}}});f.result.then(b,e)},a.Stop=function(){clearInterval(a.timerInterval),g.stop()},a.Start=function(){a.itemsPerPage=10,a.$watch("currentPage + itemsPerPage",function(){
j()}),g.start(),a.isTimeOut=!1,a.timerInterval=setInterval(h,100)},a.goToCourses=function(){b.location.href="Index#/CourseDetail/"+JSON.parse(localStorage.getItem("courseId"))},a.getCurrentIndex=function(b){return(a.currentPage-1)*a.itemsPerPage+b},a.ConfirmSubmit=function(){a.open("Confirmation",a.Submit)},a.Submit=function(){a.isTimeOut&&(a.message+=" Time is out!"),a.isTimeOut=!0,a.Stop();var d={Id:c.wordSuiteId,WordTranslations:a.typedWords};a.isChecked=!0,e.sendResult(d).then(function(b){a.answer=b.WordTranslations,j(),a.rightAnswerCount=0;for(var c in a.answer)a.answer[c].Result&&++a.rightAnswerCount;a.isSubmitSuccessful=!0,a.open("Result",function(){},a.message+" Result: "+a.rightAnswerCount+"/"+a.totalItems)},function(a){b.open("An error has occured",function(){},a.ExceptionMessage||a.Message||"Unknown error")})};var f=1e3,g=new Timer,h=function(){g.getMiliseconds()>g.getGoalTime()&&0!==g.getGoalTime()?(a.isTimeOut=!0,a.Submit()):a.time=g.getMiliseconds(),a.$apply()},j=function(){var b=(a.currentPage-1)*a.itemsPerPage,c=b+a.itemsPerPage;a.filteredWords=a.words.slice(b,c)},k=function(){a.isTimeOut=!0,a.currentTime="00:00:00",a.typedWords=[],a.isChecked=!1,a.words=[],a.currentPage=1,a.message="Your result are saved!",a.time=0,e.getWords(c.wordSuiteId).then(function(b){if(a.label=b.Name,a.words=b.WordTranslations,a.words.length){for(a.totalItems=a.words.length,i=0;i<a.totalItems;++i)a.typedWords[i]={Id:a.words[i].Id,TranslationWord:""};a.time=b.QuizResponseTime*a.totalItems*f,g.setGoalTime(a.time),a.open("startQuiz",a.Start,a.time,a.Start)}else a.open("errorModal",a.goToCourses,"Sorry, you learned all words")},function(b){a.open("errorModal",a.goToCourses,b.ExceptionMessage||b.Message||"Unknown error")})};k()}),app.controller("ModalController",function(a,b,c){a.data=c,a.close=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}),app.controller("RegisterController",function(a,b,c,d,e,f){var g=f.zero;a.strengthValue=!1,a.customStyle={},a.closeModal=function(){d.close()},a.turnYellow=function(){a.customStyle.style={color:"orange"}},a.turnGreen=function(){a.customStyle.style={color:"green"}},a.turnRed=function(){a.customStyle.style={color:"red"}},a.registerButtonClick=function(){if(g)a.errorMessage=f.pleaseWaitMessage;else{g++,a.errorMessage="";var b={login:a.nameValue+" "+a.surnameValue,password:a.passwordValue,email:a.emailValue};a.nameValue&&a.surnameValue?a.emailValue?a.passwordValue&&a.repeatPasswordValue?a.passwordValue!==a.repeatPasswordValue?(a.errorMessage=f.invalidConfirmPassword,g=f.zero):a.strengthValue?b.email&&b.password?e.registerUser(b).then(function(b){b?(d.close(),window.location.replace("/Index#/EmailSentPage")):(g=f.zero,a.errorMessage=f.existUser)},function(){g=f.zero,a.errorMessage=f.existUser}):(g=f.zero,a.errorMessage=f.inputData):(a.errorMessage=f.invalidStrengthPassword,g=f.zero):(a.errorMessage=f.invalidPassword,g=f.zero):(a.errorMessage=f.invalidEmail,g=f.zero):(a.errorMessage=f.invalidName,g=f.zero)}},a.setLabelColor=function(){var b=new RegExp("^(?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$","g"),c=new RegExp("^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$","g"),d=new RegExp("(?=.{6,}).*","g");0==d.test(a.passwordValue)?(a.turnRed(),$("#passstrength").html("More Characters")):b.test(a.passwordValue)?(a.strengthValue=!0,a.turnGreen(),$("#passstrength").html("Strong!")):c.test(a.passwordValue)?(a.strengthValue=!0,a.turnYellow(),$("#passstrength").html("Medium!")):(a.turnRed(),$("#passstrength").html("Weak!"))}}),app.controller("ResetPasswordController",function(a,b,c,d,e,f){a.closeModal=function(){d.close()},a.passwordResetClick=function(){a.errorMessage="";var b={login:a.nameValue,password:a.passwordValue,email:a.emailValue};e.sendPasswordReset(b).then(function(b){b?(d.close(),window.location.replace("/Index#/EmailSentPage")):a.errorMessage=f.somethingWrong},function(){a.errorMessage=f.wrongEmail})}}),app.controller("StudentProgressChartController",function(a,b,c,d,e,f){a.init=function(){a.isPassedValueValid=h(c.groupId)&&h(c.userId),a.isPassedValueValid&&f.getUserNameById(c.userId).then(function(b){a.userName=b,d.getGroupById(c.groupId).then(function(b){a.group=b,null==a.group?a.isPassedValueValid=!1:e.getCourseDetailWithUserId(a.group.CourseId,c.userId).then(function(b){a.course=b,g()})})},function(b){a.isPassedValueValid=!1})};var g=function(){var b=[],c=[];for(var d in a.course.WordSuites)b.push({y:a.course.WordSuites[d].Progress,label:a.course.WordSuites[d].Name}),c.push({y:100-a.course.WordSuites[d].Progress,label:a.course.WordSuites[d].Name});var e=new CanvasJS.Chart("chartContainer",{title:{text:a.course.Name},axisY:{title:"percent"},animationEnabled:!0,toolTip:{shared:!0,content:"{name}: <strong>#percent%</strong>"},data:[{type:"stackedBar100",showInLegend:!0,name:"Done Work",dataPoints:b},{type:"stackedBar100",showInLegend:!0,name:"Remaining Work",dataPoints:c}]});e.render()},h=function(a){var b=/^\d+$/;return b.test(a)};a.init()}),app.controller("StudentProgressController",function(a,b,c,d,e,f){a.init=function(){a.isPassedValueValid=g(c.groupId)&&g(c.userId),a.isPassedValueValid&&f.getUserNameById(c.userId).then(function(b){a.userName=b,d.getGroupById(c.groupId).then(function(b){a.group=b,null==a.group?a.isPassedValueValid=!1:e.getCourseDetailWithUserId(a.group.CourseId,c.userId).then(function(b){a.course=b})})},function(b){a.isPassedValueValid=!1})};var g=function(a){var b=/^\d+$/;return b.test(a)};a.init()}),app.controller("TeacherManagerController",function(a){a.replaseToCourses=function(){location.replace("Index#/UserCourses")},a.replaseToWordSuites=function(){location.replace("Index#/WordSuites")},a.replaseToWords=function(){location.replace("Index#/GlobalDictionary")},a.replaseToGroups=function(){location.replace("Index#/Groups")}}),app.controller("TutorController",function(a,b,c,d,e){a.open=function(a,b,d){var e=c.open({animation:!0,templateUrl:a,controller:"ModalController",size:"sm",resolve:{data:function(){return d}}});e.result.then(b)},a.goToCourses=function(){b.location.replace("Index#/CourseDetail/"+JSON.parse(localStorage.getItem("courseId")))},a.isSoundOn=!0,a.turnMusic=function(){a.isSoundOn=!a.isSoundOn},a.check=function(c){a.isCheck=!0,a.classes[a.rightNumber]="btn btn-success",a.timeInterval=b.setTimeout(l,700),c!==a.rightNumber?(a.classes[c]="btn btn-danger",a.isSoundOn&&i("errorAudio")):a.isSoundOn&&i("rightAudio")};var f=[],g=4,h=function(){var b=Math.floor(Math.random()*a.words.length);return f[b]!==!0?(f[b]=!0,b):h()},i=function(a){document.getElementById(a).play()},j=function(){a.rightNumber=Math.floor(Math.random()*g)},k=function(){for(var b=0;g>b;b++)a.chosenWords[b]=a.words[h()]},l=function(){a.isCheck=!1,f=[],a.chosenWords=[],a.classes=["btn btn-default","btn btn-default","btn btn-default","btn btn-default"],a.rightNumber=0,b.clearTimeout(a.timeInterval),k(),j(),a.$apply()},m=function(){e.getWords(d.wordSuiteId).then(function(b){a.label=b.Name,a.words=b.WordTranslations,a.words.length<g?a.open("smallWordSuite",a.goToCourses):l()})};m()}),app.controller("ModalController",function(a,b,c){a.data=c,a.close=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}),app.controller("UnassignedModalController",function(a,b){a.actionResult=function(){b.close()}}),app.controller("UnauthorizeModalController",function(a,b,c,d,e){c.loginButton=function(){b.isPrivate=!0,d.open({templateUrl:"../Views/LoginModal.html",controller:"LoginController",size:e.small})},c.closeModal=function(){a.close()},c.registerButton=function(){b.isPrivate=!0,d.open({templateUrl:"../Views/RegisterModal.html",controller:"RegisterController",size:e.small})}}),app.controller("UserCoursesController",function(a,b,c,d,e){b.topCount=3,b.confirmRemoving=function(a){b.courseId=a.Id,b.open("confirmModal",b.removeCourse)},b.removeCourse=function(){d.removeCourse(b.courseId).then(function(a){b.init()},function(a){b.open("errorModal",b.goToCourses,a.ExceptionMessage||a.Message||"Unknown error")})},b.open=function(b,c,d,e){var f=a.open({animation:!0,templateUrl:b,controller:"ModalController",size:"sm",resolve:{data:function(){return d}}});f.result.then(c,e)},b.init=function(){d.getUserCourses().then(function(a){b.courses=a})},b.init()}),app.controller("UsersConfiguringController",function(a,b,c,d){a.transformUsers=function(b){for(var c=[],d=0;d<b.length;++d)c.push({Id:b[d].Id,Name:b[d].Name,Email:b[d].Email,isAdmin:a.checkIfIsAdmin(b[d]),isStudent:a.checkIfIsStudent(b[d]),isTeacher:a.checkIfIsTeacher(b[d]),isBeingEdited:!1});return c},a.init=function(){a.tempRole=0,a.selectedPage=1,a.valueToSearch="",a.USERS_ON_PAGE=d.USERS_ON_PAGE,a.ID_OF_ADMIN_ROLE=d.ID_OF_ADMIN_ROLE,a.ID_OF_STUDENT_ROLE=d.ID_OF_STUDENT_ROLE,a.ID_OF_TEACHER_ROLE=d.ID_OF_TEACHER_ROLE,a.usersWhichAreBeingEdited=[],c.getAmountOfUsersByRoleId(a.tempRole).then(function(b){a.amountOfUsersByTempRole=b,c.getUsersFromInterval((a.selectedPage-1)*d.USERS_ON_PAGE,Math.min(a.selectedPage*d.USERS_ON_PAGE,a.amountOfUsersByTempRole),a.tempRole).then(function(b){a.UserList=a.transformUsers(b)})})},a.search=function(){a.valueToSearch.length<1?a.changeDataToShow():c.searchUserByName(a.valueToSearch,a.tempRole).then(function(b){a.amountOfUsersByTempRole=b.length,a.UserList=a.transformUsers(b)})},a.roleChanged=function(){a.selectedPage=1,a.changeDataToShow()},a.changeDataToShow=function(){c.getAmountOfUsersByRoleId(a.tempRole).then(function(b){a.amountOfUsersByTempRole=b,c.getUsersFromInterval((a.selectedPage-1)*d.USERS_ON_PAGE,Math.min(a.selectedPage*d.USERS_ON_PAGE,a.amountOfUsersByTempRole),a.tempRole).then(function(b){a.UserList=a.transformUsers(b)})})},a.checkIfIsAdmin=function(a){for(var b=0;b<a.Roles.length;++b)if(a.Roles[b].Name===d.ADMIN_ROLE_NAME)return!0;return!1},a.checkIfIsTeacher=function(a){for(var b=0;b<a.Roles.length;++b)if(a.Roles[b].Name===d.TEACHER_ROLE_NAME)return!0;return!1},a.checkIfIsStudent=function(a){for(var b=0;b<a.Roles.length;++b)if(a.Roles[b].Name===d.STUDENT_ROLE_NAME)return!0;return!1},a.addToListOfUsersWhichAreBeingEdited=function(b){a.UserList[b].isBeingEdited=!0};var e=function(a){var b=[];return a.isAdmin===!0&&b.push({Id:d.ID_OF_ADMIN_ROLE,Name:d.ADMIN_ROLE_NAME}),a.isTeacher===!0&&b.push({Id:d.ID_OF_TEACHER_ROLE,Name:d.TEACHER_ROLE_NAME}),a.isStudent===!0&&b.push({Id:d.ID_OF_STUDENT_ROLE,Name:d.STUDENT_ROLE_NAME}),{Id:a.Id,Email:a.Email,Name:a.Name,Roles:b}};a.removedFromListOfUsersWhichAreBeingChanged=function(b){c.changeRolesOfUser(e(a.UserList[b])).then(function(c){a.UserList[b].isBeingEdited=!1},function(a){ModalService.showResultModal(d.failureTitleForModal,d.messageErrorOnServerSide,!1)})},a.init()}),app.controller("WordSuiteCollectionController",function(a,b){b.getEnrollCourses().then(function(c){a.wordsuites=[];for(var d=c.length,e=0;d>e;e++){var f=c[e].Id;b.getCourseDetail(f).then(function(b){for(var c=0;c<b.WordSuites.length;c++){var d={title:b.WordSuites[c].Name,progress:b.WordSuites[c].Progress};a.wordsuites.push(d)}})}})}),app.controller("CreateWordSuiteController",CreateWordSuiteCtrl),app.controller("EditWordSuiteController",EditWordSuiteCtrl),app.controller("WordSuiteProgressController",function(a){a.progressBarStyle={width:a.ws.progress+"%"};var b=a.ws.progress;a.progressBarClass=25>b?"progress-bar-danger":50>b?"progress-bar-warning":75>b?"progress-bar-info":"progress-bar-success"}),app.controller("WordSuiteWordsController",function(a,b,c,d,e,f){a.PdfWords=function(){b.open("../api/wordsuite/pdfwords?id="+a.wordSuite.Id)},a.PdfTask=function(){b.open("../api/wordsuite/pdftask?id="+a.wordSuite.Id)},a.openAddWordTranslationModal=function(){var b=c.open({templateUrl:"addWordTranslationModal",controller:"AddWordTranslationsModalController",size:"lg",resolve:{id:function(){return a.wordSuite.Id},languageId:function(){return a.wordSuite.LanguageId},existingWordTranslations:function(){return a.wordSuite.WordTranslations}}});b.result.then(function(a){a&&init()})},a.listen=function(a){if("speechSynthesis"in window&&g){var b=new SpeechSynthesisUtterance(a);b.lang=g,window.speechSynthesis.speak(b)}},a.remove=function(b){var d=c.open({templateUrl:"confirmModal",controller:"ConfirmModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return"Delete Word Translation"},bodyText:function(){return"Are you sure you want to delete this Word Translation?"}}});d.result.then(function(c){c&&e.removeWordProgress({WordSuiteId:a.wordSuite.Id,WordTranslationId:a.wordSuite.WordTranslations[b].Id}).then(function(a){init()},function(a){console.log("fail")})})},a.sort=function(b,c){a.wordSuite.WordTranslations.sort(j(c)),b||a.wordSuite.WordTranslations.reverse()};var g,h=function(){e.getWordsFromWordSuite(d.wordSuiteId).then(function(b){a.wordSuite=b,i(a.wordSuite.LanguageId)})},i=function(a){f.getAllLanguages().then(function(b){for(var c,d=0;d<b.length;d++)if(b[d].Id===a){c=b[d].Name;break}if(c)switch(c){case"English":g="en-US";break;case"German":g="de-DE";break;case"French":g="fr-FR"}})},j=function(a){return function(b,c){return String(b[a]).toLowerCase()<String(c[a]).toLowerCase()?-1:String(b[a]).toLowerCase()>String(c[a]).toLowerCase()?1:0}};h()}),app.controller("WordSuitesController",WordSuitesCtrl),app.controller("WordsController",function(a,b,c,d,e,f,g,h,i,j){a.initialize=function(){a.selectedLanguageId=0,h.getAllLanguages().then(function(b){a.languages=b}),a.valueOfWordToAdd=null,a.descriptionOfWordToAdd=null,a.transcriptionOfWordToAdd=null,a.languageIdOfWordToAdd=j,a.typeOfAdding=4==a.languageIdOfWordToAdd?"translation":"word"},a.selectLanguage=function(){g.getWordsByLanguageId(a.selectedLanguageId).then(function(b){a.words=b})},a.addWord=function(){if(null===a.valueOfWordToAdd||null===a.languageOfWordToAdd)return void f.showResultModal(i.failureTitleForModal,i.messageWhenSomeRequiredFieldsAreEmpty,!1);var b={value:a.valueOfWordToAdd,description:a.descriptionOfWordToAdd,transcription:a.transcriptionOfWordToAdd,languageId:a.languageIdOfWordToAdd};g.addWord(b).then(function(a){0!=a?f.showResultModal(i.successTitleForModal,i.messageWhenWordIsAdded,!0):f.showResultModal(i.failureTitleForModal,i.messageWhenWordIsntAdded,!1)}),a.close()},a.close=function(){e.close()},a.cancel=function(){e.dismiss("cancel")},a.initialize()}),app.service("ChangePasswordService",function(a,b,c){this.changePassword=function(a){var d=b.defer();return c.post("api/register/ChangePassword",a,d),d.promise}}),app.service("ConstService",function(){this.wrongName="Wrong Name",this.wrongPassword="Wrong Password",this.wrongEmail="Wrong Email",this.savedSettings="Settings are saved",this.nameNotFound="Name Not Found",this.inputData="Fill all fields!",this.invalidInput="Your input is invalid",this.invalidPassword="Enter password",this.invalidConfirmPassword="Passwords are different",this.invalidEmail="Enter Email",this.invalidConfirmPassword="Please input new password and confirm password",this.invalidName="Please write your full name and surname",this.invalidStrengthPassword="Password must be stronger",this.pleaseWaitMessage="Please wait. Your request is loading.",this.existUser="User with specified e-mail already exists",this.wrongEmailOrPassword="Wrong e-mail or password",this.cantHandleRequest="Sorry, we can't handle your request :(",this.somethingWrong="Something went wrong...",this.StudentRole="Student",this.TeacherRole="Teacher",this.AdminRole="Admin",this.small="sm",this.userData="userData",this.sidebarClosed="sidebar-closed",this.sidebarMinimized="sidebar-minimized",this.zero=0,this.name=0,this.surname=1,this.nameLength=2,this.strength=4,this.coursePath="http://localhost:3138/Index#/Courses",this.teacherPath="http://localhost:3138/Index#/TeacherManager",this.USERS_ON_PAGE=5,this.ID_OF_ADMIN_ROLE=1,this.ID_OF_TEACHER_ROLE=2,this.ID_OF_STUDENT_ROLE=3,this.TEACHER_ROLE_NAME="Teacher",this.STUDENT_ROLE_NAME="Student",this.ADMIN_ROLE_NAME="Admin",this.successTitleForModal="Sucess",this.failureTitleForModal="Failure",this.messageWhenWordIsntAdded="Sorry, your word has not been added",this.messageWhenWordIsAdded="Word is successfully added",this.messageWhenWordTranslationIsAdded="Your word translation has been created",this.messageWhenSomeRequiredFieldsAreEmpty="Some required fields are empty",this.messageWhichSaysThatYouMustChooseValueFromDropdownList="Please, choose word from dropdown list or create you own word",this.messageErrorOnServerSide="Something went wrong",this.WORDS_ON_PAGE=10}),app.service("CourseService",function(a,b){this.getEnrollCourses=function(){var c=a.defer();return b.get("/api/Course/StudentCourses",c),c.promise},this.getUserCourses=function(){var c=a.defer();return b.get("/api/course/TeacherCourses",c),c.promise},this.getCourse=function(c){var d=a.defer();return b.get("/api/course/"+c,d),d.promise},this.getCourseDetail=function(c){var d=a.defer();return b.get("/api/course/progress?id="+c,d),d.promise},this.getCourseDetailWithUserId=function(c,d){var e=a.defer();return b.get("/api/course/progressbyuserid?courseId="+c+"&userId="+d,e),e.promise},this.createCourse=function(c){var d=a.defer();return b.post("api/course/createcourse",c,d),d.promise},this.removeCourse=function(c){var d=a.defer();return b["delete"]("/api/course?courseId="+c,d),d.promise},this.editCourse=function(c){var d=a.defer();return b.post("api/course/editcourse",c,d),d.promise}}),app.service("EditUserProfileSevice",function(a,b,c){this.getUserName=function(){var b=a.defer();return c.get("api/EditUserProfile/GetName",b),b.promise},this.editUserName=function(b){var d=a.defer();return c.post("api/EditUserProfile/EditName?editName="+b,null,d),d.promise},this.editUserPassword=function(b){var d=a.defer();return c.post("api/EditUserProfile/EditPassword?newPassword="+b,null,d),d.promise},this.passwordIsInBase=function(b){var d=a.defer();return c.post("api/EditUserProfile/CheckPassword?checkPassword="+b,null,d),d.promise},this.nameIsInBase=function(b){var d=a.defer();return c.post("api/EditUserProfile/CheckName?checkName="+b,null,d),d.promise},this.getUserNameById=function(b){var d=a.defer();return c.get("api/EditUserProfile/GetNameById?userId="+b,d),d.promise}}),app.service("EnrollmentService",function(a,b,c){this.getEnrollmentsByGroupId=function(a){var d=b.defer();return c.get("/api/Enrollment/getEnrollmentsByGroupId?groupId="+a,d),d.promise},this.getUsersNotBeongingToGroup=function(a){var d=b.defer();return c.get("/api/Enrollment/getUsersNotBelongingToGroup?groupId="+a,d),d.promise},this.enrollUsersToGroup=function(a,d){var e=b.defer(),f={userModels:a,groupId:d};return c.post("api/Enrollment/enrollUsersToGroup/",f,e),e.promise},this.deleteEnrollmentById=function(a){var d=b.defer();return c["delete"]("/api/Enrollment?enrollmentId="+a,d),d.promise}}),app.service("GroupService",function(a,b,c){this.getAllGroups=function(){var a=b.defer();return c.get("/api/Group",a),a.promise},this.getGroupById=function(a){var d=b.defer();return c.get("/api/Group?groupId="+a,d),d.promise},this.createGroup=function(a){var d=b.defer();return c.post("/api/Group",a,d),d.promise},this.deleteGroupById=function(a){var d=b.defer();return c["delete"]("/api/Group?groupId="+a,d),d.promise},this.getAllCourses=function(){var a=b.defer();return c.get("/api/Group/getCourses",a),a.promise}}),app.service("HttpRequest",function(a,b,c){var d=function(){var b=c.getUserData();if(b){var d=SHA256(b.id.toString()),e=b.hashToken;a.defaults.headers.common.Authorization="Basic "+e+" "+d+" "+b.roles.join(" ")}else a.defaults.headers.common.Authorization=null};this.get=function(b,c){d(),a.get(b).success(function(a){c.resolve(a)}).error(function(a){c.reject(a)})},this.post=function(b,c,e){d(),a.post(b,c).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)})},this["delete"]=function(b,c){d(),a["delete"](b).success(function(a){c.resolve(a)}).error(function(a){c.reject(a)})}}),app.service("IndexService",function(a){this.isLoggedInto=function(){return Boolean(a.getUserData())}}),app.service("LanguageService",function(a,b,c){this.getAllLanguages=function(){var a=b.defer();return c.get("/api/language",a),a.promise},this.addLanguage=function(a){var d=b.defer();return c.post("/api/language",a,d),d.promise},this.removeLanguage=function(a){var d=b.defer();return c["delete"]("/api/language?id="+a,d),d.promise}}),app.service("LoginService",function(a,b){var c={id:null,email:null,roles:null,encode:function(a){var b=window.atob(a.EmailAndIdToken).split(" ");c.id=b[0],c.email=b[1],c.roles=window.atob(a.RolesToken).split("|"),c.hashToken=a.HashToken}};this.login=function(d){var e=b.defer();return a.post("api/login",d).success(function(a){c.encode(a),e.resolve(c)}).error(function(a){e.reject(a)}),e.promise}}),app.service("ModalService",function(a){this.showResultModal=function(b,c,d){a.open({templateUrl:"messageModal",controller:"MessageModalController",size:"sm",backdrop:"static",keyboard:!1,resolve:{titleText:function(){return b},bodyText:function(){return c},success:function(){return d}}})}}),app.service("MyPageService",function(a,b,c){this.getUserInfo=function(a){var d=b.defer();return c.get("/api/MyPage/"+a,d),d.promise}}),app.service("QuizService",function(a,b,c){this.getWords=function(a){var d=b.defer();return c.get("api/TrainingWordSuite/Task?id="+a,d),d.promise},this.sendResult=function(a){var d=b.defer();return c.post("/api/TrainingWordSuite",a,d),d.promise}}),app.service("RegisterService",function(a,b){var c={id:null,email:null,roles:null};this.registerUser=function(e){var f=b.defer();return a.post("api/register",e).success(function(a){d(a),f.resolve(c)}).error(function(a){f.reject(a)}),f.promise};var d=function(a){c.id=window.atob(a.EmailAndIdToken).replace(/[a-zA-Z@.]/g,""),c.email=window.atob(a.EmailAndIdToken).replace(/[0-9]/g,""),c.claims=window.atob(a.RolesToken).split("|")}}),app.service("ResetPasswordService",function(a,b,c){this.sendPasswordReset=function(a){var d=b.defer();return c.post("api/register/ForgotPassword",a,d),d.promise}}),app.service("TutorService",function(a,b,c){this.getWords=function(a){var d=b.defer();return c.get("api/TrainingWordSuite/NotStudiedWords?id="+a,d),d.promise}}),app.service("UserService",function(a,b,c){this.getUserData=function(){return JSON.parse(localStorage.getItem(c.userData))},this.setUserData=function(a){a=JSON.stringify(a),localStorage.setItem(c.userData,a)},this.getUserDataForConfiguringAsAdmin=function(){var c=b.defer(),d=this.getUserData(),e=SHA256(d.id.toString()),f=d.hashToken;return a.defaults.headers.common.Authorization="Basic "+f+" "+e+" "+d.roles.join(" "),a.get("/api/UsersList").success(function(a){c.resolve(a)}).error(function(a){c.reject(a)}),c.promise},this.getAmountOfUsersByRoleId=function(c){var d=b.defer();return a.get("/api/UsersList?roleId="+c).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},this.getUsersFromInterval=function(c,d,e){var f=b.defer();return a.get("/api/UsersList?start="+c+"&end="+d+"&roleid="+e).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},this.changeRolesOfUser=function(c){var d=b.defer();return a.put("api/UsersList",c).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},this.searchUserByName=function(c,d){var e=b.defer();return a.get("api/UsersList?namevaluetosearch="+c+"&roleid="+d).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise}}),app.service("WordSuiteService",function(a,b,c){this.createWordSuite=function(a){var d=b.defer();return c.post("api/wordsuite/CreateWordSuite",a,d),d.promise},this.editWordSuite=function(a){var d=b.defer();return c.post("api/wordsuite/EditWordSuite",a,d),d.promise},this.getWordSuitesByOwnerID=function(a){var d=b.defer();return c.get("api/wordsuite/GetTeacherWordSuites?id="+a,d),d.promise},this.getWordSuitesByLanguageID=function(a){var d=b.defer();return c.get("api/wordsuite/GetWordSuitesByLanguageId?languageId="+a,d),d.promise},this.getWordSuiteByID=function(a){var d=b.defer();return c.get("api/wordsuite/GetWordSuiteByID?id="+a,d),d.promise},this.getWordsFromWordSuite=function(a){var d=b.defer();return c.get("api/TrainingWordSuite/AllWords?id="+a,d),d.promise},this.getPrintVersion=function(a){var d=b.defer();return c.get("api/wordsuite/"+a+"/pdf",d),d.promise},this.addWordProgresses=function(a){var d=b.defer();return c.post("api/wordsuite/AddWordProgresses",a,d),d.promise},this.removeWordProgress=function(a){var d=b.defer();return c.post("api/wordsuite/RemoveWordProgresses",a,d),d.promise},this.deleteWordSuite=function(a){var d=b.defer();return c["delete"]("api/WordSuite?id="+a,d),d.promise}}),app.service("WordTranslationService",function(a,b,c){this.searchForWordTranslations=function(a,d){var e=b.defer();return c.get("api/WordTranslation?searchWord="+a+"&languageId="+d,e),e.promise},this.getWordTranslationsByWordSuiteID=function(a){var d=b.defer();return c.get("api/WordTranslation?ID="+a,d),d.promise},this.importWordTranslations=function(a){var d=b.defer();return c.post("api/WordTranslation/ImportWordTranslations",a,d),d.promise},this.addWordTranslation=function(a){var d=b.defer();return c.post("/api/WordTranslation/CreateWordTranslation",a,d),d.promise},this.getWordTranslationsFromInterval=function(a,d,e){var f=b.defer();return c.get("/api/GlobalDictionary?start="+a+"&end="+d+"&language="+e,f),f.promise},this.getAmountOfWordTranslationsBySpecificLanguage=function(a){var d=b.defer();return c.get("/api/GlobalDictionary?languageID="+a,d),d.promise}}),app.service("WordsService",function(a,b,c){this.getWordsByLanguageId=function(a){var d=b.defer();return c.get("/api/words?languageId="+a,d),d.promise},this.addWord=function(a){var d=b.defer();return c.post("/api/Words",a,d),d.promise},this.getWordById=function(a){var d=b.defer();return c.get("/api/Words?wordId="+a,d),d.promise},this.searchForWords=function(a,d,e){var f=b.defer();return c.get("api/Words?searchWord="+a+"&languageId="+d+"&searchResultsCount="+e,f),f.promise},this.searchForTranslations=function(a,d){var e=b.defer();return c.get("api/Words?searchWord="+a+"&languageId=4&searchResultsCount="+d,e),e.promise}}),app.filter("milisecondToDateTime",[function(){return function(a){return new Date(1970,0,1).setMilliseconds(a)}}]),app.filter("TimeWithWords",[function(){return function(a){var b="";a/=6e4;var c=Math.floor(a);c&&(b=c+" minute",1!==c&&(b+="s"));var d=Math.round(a%1*60);return d&&(b+=" "+d+" second",1!==d&&(b+="s")),b}}]),app.filter("top",function(){return function(a,b){return a.filter(function(a,c){return b>c})}}),app.directive("passwordStrength",[function(){return{require:"ngModel",restrict:"E",scope:{password:"=ngModel"},link:function(a,b,c,d){a.$watch("password",function(b){function c(a){return a?1:0}a.strength=c(b&&b.length>=8)+c(b&&/[A-z]/.test(b))+c(b&&/(?=.*\W)/.test(b))+c(b&&/\d/.test(b)),sessionStorage.strength=a.strength},!0)},template:'<div class="progress"><div class="progress-bar progress-bar-danger" style="width: {{strength >= 1 ? 25 : 0}}%"></div><div class="progress-bar progress-bar-warning" style="width: {{strength >= 2 ? 25 : 0}}%"></div><div class="progress-bar progress-bar-warning" style="width: {{strength >= 3 ? 25 : 0}}%"></div><div class="progress-bar progress-bar-success" style="width: {{strength >= 4 ? 25 : 0}}%"></div></div>',controller:"EditUserProfileController"}}]),app.directive("patternValidator",[function(){return{require:"ngModel",restrict:"A",link:function(a,b,c,d){d.$parsers.unshift(function(a){var b=new RegExp(c.patternValidator),e=b.test(a);return d.$setValidity("passwordPattern",e),a})},controller:"EditUserProfileController"}}]),app.directive("ngDropdownMultiselect",["$filter","$document","$compile","$parse",function(a,b,c,d){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",groupBy:"@"},template:function(a,b){var c=b.checkboxes?!0:!1,d=b.groupBy?!0:!1,e='<div class="multiselect-parent btn-group dropdown-multiselect">';e+='<button type="button" class="dropdown-toggle" ng-class="settings.buttonClasses" ng-click="toggleDropdown()">{{getButtonText()}}&nbsp;<span class="caret"></span></button>',e+="<ul class=\"dropdown-menu dropdown-menu-form\" ng-style=\"{display: open ? 'block' : 'none', height : settings.scrollable ? settings.scrollableHeight : 'auto' }\" style=\"overflow: scroll\" >",e+='<li ng-hide="!settings.showCheckAll || settings.selectionLimit > 0"><a data-ng-click="selectAll()"><span class="glyphicon glyphicon-ok"></span>  {{texts.checkAll}}</a>',e+='<li ng-show="settings.showUncheckAll"><a data-ng-click="deselectAll();"><span class="glyphicon glyphicon-remove"></span>   {{texts.uncheckAll}}</a></li>',e+='<li ng-hide="(!settings.showCheckAll || settings.selectionLimit > 0) && !settings.showUncheckAll" class="divider"></li>',e+='<li ng-show="settings.enableSearch"><div class="dropdown-header"><input type="text" class="form-control" style="width: 100%;" ng-model="searchFilter" placeholder="{{texts.searchPlaceholder}}" /></li>',e+='<li ng-show="settings.enableSearch" class="divider"></li>',d?(e+='<li ng-repeat-start="option in orderedItems | filter: searchFilter" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role="presentation" class="dropdown-header">{{ getGroupTitle(getPropertyForObject(option, settings.groupBy)) }}</li>',e+='<li ng-repeat-end role="presentation">'):e+='<li role="presentation" ng-repeat="option in options | filter: searchFilter">',e+='<a role="menuitem" tabindex="-1" ng-click="setSelectedItem(getPropertyForObject(option,settings.idProp))">',e+=c?'<div class="checkbox"><label><input class="checkboxInput" type="checkbox" ng-click="checkboxClick($event, getPropertyForObject(option,settings.idProp))" ng-checked="isChecked(getPropertyForObject(option,settings.idProp))" /> {{getPropertyForObject(option, settings.displayProp)}}</label></div></a>':"<span data-ng-class=\"{'glyphicon glyphicon-ok': isChecked(getPropertyForObject(option,settings.idProp))}\"></span> {{getPropertyForObject(option, settings.displayProp)}}</a>",e+="</li>",e+='<li class="divider" ng-show="settings.selectionLimit > 1"></li>',e+='<li role="presentation" ng-show="settings.selectionLimit > 1"><a role="menuitem">{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li>',e+="</ul>",e+="</div>",a.html(e)},link:function(c,d,e){function f(a){var b={};return""===c.settings.externalIdProp?b[c.settings.idProp]=a:b[c.settings.externalIdProp]=a,b}function g(a){for(var b in a)delete a[b]}var h=d.children()[0];c.toggleDropdown=function(){c.open=!c.open},c.checkboxClick=function(a,b){c.setSelectedItem(b),a.stopImmediatePropagation()},c.externalEvents={onItemSelect:angular.noop,onItemDeselect:angular.noop,onSelectAll:angular.noop,onDeselectAll:angular.noop,onInitDone:angular.noop,onMaxSelectionReached:angular.noop},c.settings={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"label",idProp:"id",externalIdProp:"id",enableSearch:!1,selectionLimit:0,showCheckAll:!0,showUncheckAll:!0,closeOnSelect:!1,buttonClasses:"btn btn-default",closeOnDeselect:!1,groupBy:e.groupBy||void 0,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:angular.noop},c.texts={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Search...",buttonDefaultText:"Select",dynamicButtonTextSuffix:"checked"},c.searchFilter=c.searchFilter||"",angular.isDefined(c.settings.groupBy)&&c.$watch("options",function(b){angular.isDefined(b)&&(c.orderedItems=a("orderBy")(b,c.settings.groupBy))}),angular.extend(c.settings,c.extraSettings||[]),angular.extend(c.externalEvents,c.events||[]),angular.extend(c.texts,c.translationTexts),c.singleSelection=1===c.settings.selectionLimit,c.singleSelection&&angular.isArray(c.selectedModel)&&0===c.selectedModel.length&&g(c.selectedModel),c.settings.closeOnBlur&&b.on("click",function(a){for(var b=a.target.parentElement,d=!1;angular.isDefined(b)&&null!==b&&!d;)_.contains(b.className.split(" "),"multiselect-parent")&&!d&&b===h&&(d=!0),
b=b.parentElement;d||c.$apply(function(){c.open=!1})}),c.getGroupTitle=function(a){return null!==c.settings.groupByTextProvider?c.settings.groupByTextProvider(a):a},c.getButtonText=function(){if(c.settings.dynamicTitle&&(c.selectedModel.length>0||angular.isObject(c.selectedModel)&&_.keys(c.selectedModel).length>0)){if(c.settings.smartButtonMaxItems>0){var a=[];return angular.forEach(c.options,function(b){if(c.isChecked(c.getPropertyForObject(b,c.settings.idProp))){var d=c.getPropertyForObject(b,c.settings.displayProp),e=c.settings.smartButtonTextConverter(d,b);a.push(e?e:d)}}),c.selectedModel.length>c.settings.smartButtonMaxItems&&(a=a.slice(0,c.settings.smartButtonMaxItems),a.push("...")),a.join(", ")}var b;return b=c.singleSelection?null!==c.selectedModel&&angular.isDefined(c.selectedModel[c.settings.idProp])?1:0:angular.isDefined(c.selectedModel)?c.selectedModel.length:0,0===b?c.texts.buttonDefaultText:b+" "+c.texts.dynamicButtonTextSuffix}return c.texts.buttonDefaultText},c.getPropertyForObject=function(a,b){return angular.isDefined(a)&&a.hasOwnProperty(b)?a[b]:""},c.selectAll=function(){c.deselectAll(!1),c.externalEvents.onSelectAll(),angular.forEach(c.options,function(a){c.setSelectedItem(a[c.settings.idProp],!0)})},c.deselectAll=function(a){a=a||!0,a&&c.externalEvents.onDeselectAll(),c.singleSelection?g(c.selectedModel):c.selectedModel.splice(0,c.selectedModel.length)},c.setSelectedItem=function(a,b){var d=f(a),e=null;if(e=""===c.settings.externalIdProp?_.find(c.options,d):d,c.singleSelection)return g(c.selectedModel),angular.extend(c.selectedModel,e),c.externalEvents.onItemSelect(e),void(c.settings.closeOnSelect&&(c.open=!1));b=b||!1;var h=-1!==_.findIndex(c.selectedModel,d);!b&&h?(c.selectedModel.splice(_.findIndex(c.selectedModel,d),1),c.externalEvents.onItemDeselect(d)):!h&&(0===c.settings.selectionLimit||c.selectedModel.length<c.settings.selectionLimit)&&(c.selectedModel.push(e),c.externalEvents.onItemSelect(e)),c.settings.closeOnSelect&&(c.open=!1)},c.isChecked=function(a){return c.singleSelection?null!==c.selectedModel&&angular.isDefined(c.selectedModel[c.settings.idProp])&&c.selectedModel[c.settings.idProp]===f(a)[c.settings.idProp]:-1!==_.findIndex(c.selectedModel,f(a))},c.externalEvents.onInitDone()}}}]),function(a){function b(){return"ondrag"in document.createElement("a")}if(!b())return void a.module("ang-drag-drop",[]);window.jQuery&&-1==window.jQuery.event.props.indexOf("dataTransfer")&&window.jQuery.event.props.push("dataTransfer");var c;a.module("ang-drag-drop",[]).directive("uiDraggable",["$parse","$rootScope","$dragImage",function(b,d,e){return function(f,g,h){function i(a){setTimeout(function(){g.unbind("$destroy",i)},0);var c=h.dragChannel||"defaultchannel";if(d.$broadcast("ANGULAR_DRAG_END",c),a.dataTransfer&&"none"!==a.dataTransfer.dropEffect)if(h.onDropSuccess){var e=b(h.onDropSuccess);f.$evalAsync(function(){e(f,{$event:a})})}else if(h.onDropFailure){var e=b(h.onDropFailure);f.$evalAsync(function(){e(f,{$event:a})})}g.removeClass(n)}function j(j){var o=!m||l.classList.contains(k);if(o){var p=h.dragChannel||"defaultchannel",q="";h.drag&&(q=f.$eval(h.drag));var r=a.toJson({data:q,channel:p}),s=h.dragImage||null;if(g.addClass(n),g.bind("$destroy",i),s){var t=b(h.dragImage);f.$apply(function(){var b=t(f,{$event:j});if(b&&(a.isString(b)&&(b=e.generate(b)),b.image)){var c=b.xOffset||0,d=b.yOffset||0;j.dataTransfer.setDragImage(b.image,c,d)}})}j.dataTransfer.setData("dataToSend",r),c=a.fromJson(r),j.dataTransfer.effectAllowed="copyMove",d.$broadcast("ANGULAR_DRAG_START",p,c.data)}else j.preventDefault()}var k,l,m=!1,n=h.draggingClass||"on-dragging";g.attr("draggable",!1),h.$observe("uiDraggable",function(a){a?g.attr("draggable",a):g.removeAttr("draggable")}),a.isString(h.dragHandleClass)&&(m=!0,k=h.dragHandleClass.trim()||"drag-handle",g.bind("mousedown",function(a){l=a.target})),g.bind("dragend",i),g.bind("dragstart",j)}}]).directive("uiOnDrop",["$parse","$rootScope",function(b,d){return function(e,f,g){function h(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation();var c=b(g.uiOnDragOver);return e.$evalAsync(function(){c(e,{$event:a,$channel:o})}),a.dataTransfer.dropEffect=a.shiftKey?"copy":"move",!1}function i(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),n--,0==n&&(e.$evalAsync(function(){s(e,{$event:a})}),f.removeClass(r));var c=b(g.uiOnDragLeave);e.$evalAsync(function(){c(e,{$event:a,$channel:o})})}function j(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),n++;var c=b(g.uiOnDragEnter);e.$evalAsync(function(){c(e,{$event:a,$channel:o})}),d.$broadcast("ANGULAR_HOVER",p),e.$evalAsync(function(){t(e,{$event:a})}),f.addClass(r)}function k(c){c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation();var d=c.dataTransfer.getData("dataToSend");d=a.fromJson(d);var h=b(g.uiOnDrop);e.$evalAsync(function(){h(e,{$data:d.data,$event:c,$channel:d.channel})}),f.removeClass(q),n=0}function l(a,b){if("*"===b)return!0;var c=new RegExp("(\\s|[,])+("+a+")(\\s|[,])+","i");return c.test(","+b+",")}function m(a){return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.dataTransfer.dropEffect="none",!1}var n=0,o=g.dropChannel||"defaultchannel",p="",q=g.dragEnterClass||"on-drag-enter",r=g.dragHoverClass||"on-drag-hover",s=b(g.onDragEnter),t=b(g.onDragLeave),u=d.$on("ANGULAR_DRAG_START",function(a,d){if(p=d,l(d,o)){if(g.dropValidate){var n=b(g.dropValidate),r=n(e,{$data:c.data,$channel:c.channel});if(!r)return f.bind("dragover",m),f.bind("dragenter",m),f.bind("dragleave",m),void f.bind("drop",m)}f.bind("dragover",h),f.bind("dragenter",j),f.bind("dragleave",i),f.bind("drop",k),f.addClass(q)}else f.bind("dragover",m),f.bind("dragenter",m),f.bind("dragleave",m),f.bind("drop",m)}),v=d.$on("ANGULAR_DRAG_END",function(a,b){p="",l(b,o)&&(f.unbind("dragover",h),f.unbind("dragenter",j),f.unbind("dragleave",i),f.unbind("drop",k),f.removeClass(r),f.removeClass(q)),f.unbind("dragover",m),f.unbind("dragenter",m),f.unbind("dragleave",m),f.unbind("drop",m)}),w=d.$on("ANGULAR_HOVER",function(a,b){l(b,o)&&f.removeClass(r)});e.$on("$destroy",function(){u(),v(),w()}),g.$observe("dropChannel",function(a){a&&(o=a)})}}]).constant("$dragImageConfig",{height:20,width:200,padding:10,font:"bold 11px Arial",fontColor:"#eee8d5",backgroundColor:"#93a1a1",xOffset:0,yOffset:0}).service("$dragImage",["$dragImageConfig",function(b){function c(a,b,c){var e=a.measureText(b).width;if(e<c.width)return b;for(;e+c.padding>c.width;)b=b.substring(0,b.length-1),e=a.measureText(b+d).width;return b+d}var d="";this.generate=function(d,e){var f=a.extend({},b,e||{}),g=document.createElement("canvas");g.height=f.height,g.width=f.width;var h=g.getContext("2d");h.fillStyle=f.backgroundColor,h.fillRect(0,0,f.width,f.height),h.font=f.font,h.fillStyle=f.fontColor;var i=c(h,d,f);h.fillText(i,4,f.padding+4);var j=new Image;return j.src=g.toDataURL(),{image:j,xOffset:f.xOffset,yOffset:f.yOffset}}}])}(angular),app.directive("wordsuiteProgress",function(){return{restrict:"E",scope:{ws:"=wordsuite"},templateUrl:"../../../Views/WordSuiteProgress.html",controller:"WordSuiteProgressController"}});